VERSION 5.00
Object = "{F247AF03-2671-4421-A87A-846ED80CD2A9}#1.0#0"; "JwldButn2b.ocx"
Begin VB.Form frmPersistent 
   BorderStyle     =   4  'Fixed ToolWindow
   Caption         =   "Persistent Hotkeys"
   ClientHeight    =   4965
   ClientLeft      =   45
   ClientTop       =   315
   ClientWidth     =   4515
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4965
   ScaleWidth      =   4515
   ShowInTaskbar   =   0   'False
   StartUpPosition =   2  'CenterScreen
   Begin VB.CheckBox chkExiva11 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   36
      Top             =   4320
      Width           =   255
   End
   Begin VB.CheckBox chkExiva10 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   35
      Top             =   3960
      Width           =   255
   End
   Begin VB.CheckBox chkExiva9 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   34
      Top             =   3600
      Width           =   255
   End
   Begin VB.CheckBox chkExiva8 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   33
      Top             =   3240
      Width           =   255
   End
   Begin VB.CheckBox chkExiva7 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   32
      Top             =   2880
      Width           =   255
   End
   Begin VB.CheckBox chkExiva6 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   31
      Top             =   2520
      Width           =   255
   End
   Begin VB.CheckBox chkExiva5 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   30
      Top             =   2160
      Width           =   255
   End
   Begin VB.CheckBox chkExiva4 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   29
      Top             =   1800
      Width           =   255
   End
   Begin VB.CheckBox chkExiva3 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   28
      Top             =   1440
      Width           =   255
   End
   Begin VB.CheckBox chkExiva2 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   27
      Top             =   1080
      Width           =   255
   End
   Begin VB.CheckBox chkExiva1 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Check1"
      Height          =   255
      Left            =   100
      TabIndex        =   26
      Top             =   720
      Width           =   255
   End
   Begin VB.TextBox txtHk11 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   23
      Text            =   "100"
      Top             =   4320
      Width           =   615
   End
   Begin VB.TextBox txtExiva11 
      Height          =   315
      Left            =   360
      TabIndex        =   22
      Top             =   4320
      Width           =   3375
   End
   Begin VB.TextBox txtHk10 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   21
      Text            =   "100"
      Top             =   3960
      Width           =   615
   End
   Begin VB.TextBox txtExiva10 
      Height          =   315
      Left            =   360
      TabIndex        =   20
      Top             =   3960
      Width           =   3375
   End
   Begin VB.TextBox txtHk9 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   19
      Text            =   "100"
      Top             =   3600
      Width           =   615
   End
   Begin VB.TextBox txtExiva9 
      Height          =   315
      Left            =   360
      TabIndex        =   18
      Top             =   3600
      Width           =   3375
   End
   Begin VB.TextBox txtHk8 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   17
      Text            =   "100"
      Top             =   3240
      Width           =   615
   End
   Begin VB.TextBox txtExiva8 
      Height          =   315
      Left            =   360
      TabIndex        =   16
      Top             =   3240
      Width           =   3375
   End
   Begin VB.TextBox txtHk7 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   15
      Text            =   "100"
      Top             =   2880
      Width           =   615
   End
   Begin VB.TextBox txtExiva7 
      Height          =   315
      Left            =   360
      TabIndex        =   14
      Top             =   2880
      Width           =   3375
   End
   Begin VB.TextBox txtHk6 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   13
      Text            =   "100"
      Top             =   2520
      Width           =   615
   End
   Begin VB.TextBox txtExiva6 
      Height          =   315
      Left            =   360
      TabIndex        =   12
      Top             =   2520
      Width           =   3375
   End
   Begin VB.TextBox txtHk5 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   11
      Text            =   "100"
      Top             =   2160
      Width           =   615
   End
   Begin VB.TextBox txtExiva5 
      Height          =   315
      Left            =   360
      TabIndex        =   10
      Top             =   2160
      Width           =   3375
   End
   Begin VB.TextBox txtHk4 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   9
      Text            =   "100"
      Top             =   1800
      Width           =   615
   End
   Begin VB.TextBox txtExiva4 
      Height          =   315
      Left            =   360
      TabIndex        =   8
      Top             =   1800
      Width           =   3375
   End
   Begin VB.TextBox txtHk3 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   7
      Text            =   "100"
      Top             =   1440
      Width           =   615
   End
   Begin VB.TextBox txtExiva3 
      Height          =   315
      Left            =   360
      TabIndex        =   6
      Top             =   1440
      Width           =   3375
   End
   Begin VB.TextBox txtHk2 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   5
      Text            =   "100"
      Top             =   1080
      Width           =   615
   End
   Begin VB.TextBox txtExiva2 
      Height          =   315
      Left            =   360
      TabIndex        =   4
      Top             =   1080
      Width           =   3375
   End
   Begin VB.TextBox txtHk1 
      Alignment       =   2  'Center
      Height          =   315
      Left            =   3840
      TabIndex        =   3
      Text            =   "100"
      Top             =   720
      Width           =   615
   End
   Begin VB.TextBox txtExiva1 
      Height          =   315
      Left            =   360
      TabIndex        =   2
      Top             =   720
      Width           =   3375
   End
   Begin VB.Timer tmrPersistent 
      Interval        =   100
      Left            =   0
      Top             =   0
   End
   Begin VB.ComboBox cmbCharacter 
      Height          =   315
      Left            =   1200
      TabIndex        =   1
      Text            =   "-"
      Top             =   120
      Width           =   1815
   End
   Begin JwldButn2b.JeweledButton cmdApply 
      Height          =   255
      Left            =   3600
      TabIndex        =   24
      Top             =   150
      Width           =   855
      _ExtentX        =   1508
      _ExtentY        =   450
      Caption         =   "Save"
      PictureSize     =   0
      OriginalPicSizeW=   0
      OriginalPicSizeH=   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   99
      BorderColor_Hover=   16761024
      BorderColor_Inner=   16777215
   End
   Begin JwldButn2b.JeweledButton cmdShowhk 
      Height          =   255
      Left            =   3045
      TabIndex        =   38
      Top             =   150
      Width           =   495
      _ExtentX        =   873
      _ExtentY        =   450
      Caption         =   "List"
      PictureSize     =   0
      OriginalPicSizeW=   0
      OriginalPicSizeH=   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   99
      BorderColor_Hover=   16744576
      BorderColor_Inner=   16777215
   End
   Begin VB.Label Label6 
      Caption         =   "delay ms"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   6.75
         Charset         =   0
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   255
      Left            =   3840
      TabIndex        =   37
      Top             =   480
      Width           =   615
   End
   Begin VB.Label Label1 
      Caption         =   "FOR THE CHANGE CLICK SAVE BUTTON TO CHANGE"
      Height          =   375
      Left            =   240
      TabIndex        =   25
      Top             =   4680
      Width           =   4335
   End
   Begin VB.Label Label2 
      Caption         =   "Hotkeys:"
      Height          =   195
      Index           =   0
      Left            =   360
      TabIndex        =   0
      Top             =   120
      Width           =   615
   End
End
Attribute VB_Name = "frmPersistent"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
#Const FinalMode = 1
Option Explicit
'Private Declare Function GetAsyncKeyState Lib "user32" (ByVal vKey As Long) As Integer

Private Sub chkExiva1_Click()

If lock_chkExiva1 = False Then
If persistentIDselected > 0 Then
  If chkExiva1.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva1 = True
  Else
    persistentOptions(persistentIDselected).chkExiva1 = False
  End If
End If
End If

End Sub

Private Sub chkExiva2_Click()

If lock_chkExiva2 = False Then
If persistentIDselected > 0 Then
  If chkExiva2.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva2 = True
  Else
    persistentOptions(persistentIDselected).chkExiva2 = False
  End If
End If
End If

End Sub

Private Sub chkExiva3_Click()

If lock_chkExiva3 = False Then
If persistentIDselected > 0 Then
  If chkExiva3.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva3 = True
  Else
    persistentOptions(persistentIDselected).chkExiva3 = False
  End If
End If
End If

End Sub

Private Sub chkExiva4_Click()

If lock_chkExiva4 = False Then
If persistentIDselected > 0 Then
  If chkExiva4.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva4 = True
  Else
    persistentOptions(persistentIDselected).chkExiva4 = False
  End If
End If
End If

End Sub

Private Sub chkExiva5_Click()

If lock_chkExiva5 = False Then
If persistentIDselected > 0 Then
  If chkExiva5.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva5 = True
  Else
    persistentOptions(persistentIDselected).chkExiva5 = False
  End If
End If
End If

End Sub

Private Sub chkExiva6_Click()

If lock_chkExiva6 = False Then
If persistentIDselected > 0 Then
  If chkExiva6.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva6 = True
  Else
    persistentOptions(persistentIDselected).chkExiva6 = False
  End If
End If
End If

End Sub

Private Sub chkExiva7_Click()

If lock_chkExiva7 = False Then
If persistentIDselected > 0 Then
  If chkExiva7.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva7 = True
  Else
    persistentOptions(persistentIDselected).chkExiva7 = False
  End If
End If
End If

End Sub

Private Sub chkExiva8_Click()

If lock_chkExiva8 = False Then
If persistentIDselected > 0 Then
  If chkExiva8.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva8 = True
  Else
    persistentOptions(persistentIDselected).chkExiva8 = False
  End If
End If
End If

End Sub

Private Sub chkExiva9_Click()

If lock_chkExiva9 = False Then
If persistentIDselected > 0 Then
  If chkExiva9.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva9 = True
  Else
    persistentOptions(persistentIDselected).chkExiva9 = False
  End If
End If
End If

End Sub

Private Sub chkExiva10_Click()

If lock_chkExiva10 = False Then
If persistentIDselected > 0 Then
  If chkExiva10.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva10 = True
  Else
    persistentOptions(persistentIDselected).chkExiva10 = False
  End If
End If
End If

End Sub

Private Sub chkExiva11_Click()

If lock_chkExiva11 = False Then
If persistentIDselected > 0 Then
  If chkExiva11.value = 1 Then
    persistentOptions(persistentIDselected).chkExiva11 = True
  Else
    persistentOptions(persistentIDselected).chkExiva11 = False
  End If
End If
End If

End Sub





Private Sub cmbCharacter_Click()

 persistentIDselected = cmbCharacter.ListIndex
  If persistentIDselected > 0 Then
      UpdateValues
  End If

End Sub

Private Sub cmdApply_Click()
Dim aRes As Long
Dim idConnection As Integer
Dim i As Integer


If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk1 = txtHk1.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk2 = txtHk2.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk3 = txtHk3.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk4 = txtHk4.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk5 = txtHk5.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk6 = txtHk6.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk7 = txtHk7.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk8 = txtHk8.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk9 = txtHk9.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk10 = txtHk10.Text
End If

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtHk11 = txtHk11.Text
End If

UpdateValues

    For i = 1 To MAXCLIENTS
        idConnection = i
        aRes = ExecuteInTibia("exiva save", idConnection, True)
        DoEvents
    Next i
    
End Sub

Private Sub cmdShowhk_Click()
  frmShowhk.WindowState = vbNormal
  frmShowhk.Show
  frmShowhk.SetFocus
  SetWindowPos frmShowhk.hWnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE + SWP_NOSIZE
End Sub

Private Sub Form_Load()

LoadPersistentChars

End Sub

Public Sub UpdateValues()

If persistentIDselected = 0 Then
    If persistentOptions_chkExiva1_default = True Then
      chkExiva1.value = 1
    Else
      chkExiva1.value = 0
    End If
    If persistentOptions_chkExiva2_default = True Then
      chkExiva2.value = 1
    Else
      chkExiva2.value = 0
    End If
    If persistentOptions_chkExiva3_default = True Then
      chkExiva3.value = 1
    Else
      chkExiva3.value = 0
    End If
    If persistentOptions_chkExiva4_default = True Then
      chkExiva4.value = 1
    Else
      chkExiva4.value = 0
    End If
    If persistentOptions_chkExiva5_default = True Then
      chkExiva5.value = 1
    Else
      chkExiva5.value = 0
    End If
    If persistentOptions_chkExiva6_default = True Then
      chkExiva6.value = 1
    Else
      chkExiva6.value = 0
    End If
    If persistentOptions_chkExiva7_default = True Then
      chkExiva7.value = 1
    Else
      chkExiva7.value = 0
    End If
    If persistentOptions_chkExiva8_default = True Then
      chkExiva8.value = 1
    Else
      chkExiva8.value = 0
    End If
    If persistentOptions_chkExiva9_default = True Then
      chkExiva9.value = 1
    Else
      chkExiva9.value = 0
    End If
    If persistentOptions_chkExiva10_default = True Then
      chkExiva10.value = 1
    Else
      chkExiva10.value = 0
    End If
    If persistentOptions_chkExiva11_default = True Then
      chkExiva11.value = 1
    Else
      chkExiva11.value = 0
    End If
    txtHk1.Text = persistentOptions_txtHk1_default
    txtHk2.Text = persistentOptions_txtHk2_default
    txtHk3.Text = persistentOptions_txtHk3_default
    txtHk4.Text = persistentOptions_txtHk4_default
    txtHk5.Text = persistentOptions_txtHk5_default
    txtHk6.Text = persistentOptions_txtHk6_default
    txtHk7.Text = persistentOptions_txtHk7_default
    txtHk8.Text = persistentOptions_txtHk8_default
    txtHk9.Text = persistentOptions_txtHk9_default
    txtHk10.Text = persistentOptions_txtHk10_default
    txtHk11.Text = persistentOptions_txtHk11_default
    txtExiva1.Text = persistentOptions_txtExiva1_default
    txtExiva2.Text = persistentOptions_txtExiva2_default
    txtExiva3.Text = persistentOptions_txtExiva3_default
    txtExiva4.Text = persistentOptions_txtExiva4_default
    txtExiva5.Text = persistentOptions_txtExiva5_default
    txtExiva6.Text = persistentOptions_txtExiva6_default
    txtExiva7.Text = persistentOptions_txtExiva7_default
    txtExiva8.Text = persistentOptions_txtExiva8_default
    txtExiva9.Text = persistentOptions_txtExiva9_default
    txtExiva10.Text = persistentOptions_txtExiva10_default
    txtExiva11.Text = persistentOptions_txtExiva11_default
Else
    If persistentOptions(persistentIDselected).chkExiva1 = True Then
      chkExiva1.value = 1
    Else
      chkExiva1.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva2 = True Then
      chkExiva2.value = 1
    Else
      chkExiva2.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva3 = True Then
      chkExiva3.value = 1
    Else
      chkExiva3.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva4 = True Then
      chkExiva4.value = 1
    Else
      chkExiva4.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva5 = True Then
      chkExiva5.value = 1
    Else
      chkExiva5.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva6 = True Then
      chkExiva6.value = 1
    Else
      chkExiva6.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva7 = True Then
      chkExiva7.value = 1
    Else
      chkExiva7.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva8 = True Then
      chkExiva8.value = 1
    Else
      chkExiva8.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva9 = True Then
      chkExiva9.value = 1
    Else
      chkExiva9.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva10 = True Then
      chkExiva10.value = 1
    Else
      chkExiva10.value = 0
    End If
    If persistentOptions(persistentIDselected).chkExiva11 = True Then
      chkExiva11.value = 1
    Else
      chkExiva11.value = 0
    End If
    txtHk1.Text = persistentOptions(persistentIDselected).txtHk1
    txtHk2.Text = persistentOptions(persistentIDselected).txtHk2
    txtHk3.Text = persistentOptions(persistentIDselected).txtHk3
    txtHk4.Text = persistentOptions(persistentIDselected).txtHk4
    txtHk5.Text = persistentOptions(persistentIDselected).txtHk5
    txtHk6.Text = persistentOptions(persistentIDselected).txtHk6
    txtHk7.Text = persistentOptions(persistentIDselected).txtHk7
    txtHk8.Text = persistentOptions(persistentIDselected).txtHk8
    txtHk9.Text = persistentOptions(persistentIDselected).txtHk9
    txtHk10.Text = persistentOptions(persistentIDselected).txtHk10
    txtHk11.Text = persistentOptions(persistentIDselected).txtHk11
    txtExiva1.Text = persistentOptions(persistentIDselected).txtExiva1
    txtExiva2.Text = persistentOptions(persistentIDselected).txtExiva2
    txtExiva3.Text = persistentOptions(persistentIDselected).txtExiva3
    txtExiva4.Text = persistentOptions(persistentIDselected).txtExiva4
    txtExiva5.Text = persistentOptions(persistentIDselected).txtExiva5
    txtExiva6.Text = persistentOptions(persistentIDselected).txtExiva6
    txtExiva7.Text = persistentOptions(persistentIDselected).txtExiva7
    txtExiva8.Text = persistentOptions(persistentIDselected).txtExiva8
    txtExiva9.Text = persistentOptions(persistentIDselected).txtExiva9
    txtExiva10.Text = persistentOptions(persistentIDselected).txtExiva10
    txtExiva11.Text = persistentOptions(persistentIDselected).txtExiva11
End If

End Sub

Private Sub Form_Unload(Cancel As Integer)
  Me.Hide
  Cancel = BlockUnload
End Sub

Private Sub tmrPersistent_Timer()
Dim x1 As String
Dim say As String
Dim i1 As Long
Dim aRes As Long
Dim idConnection As Integer

For idConnection = 1 To MAXCLIENTS
If GameConnected(idConnection) = True Then

If persistentOptions(idConnection).txtHk1 < 100 Then
persistentOptions(idConnection).txtHk1 = 100
End If
If persistentOptions(idConnection).txtHk2 < 100 Then
persistentOptions(idConnection).txtHk2 = 100
End If
If persistentOptions(idConnection).txtHk3 < 100 Then
persistentOptions(idConnection).txtHk3 = 100
End If
If persistentOptions(idConnection).txtHk4 < 100 Then
persistentOptions(idConnection).txtHk4 = 100
End If
If persistentOptions(idConnection).txtHk5 < 100 Then
persistentOptions(idConnection).txtHk5 = 100
End If
If persistentOptions(idConnection).txtHk6 < 100 Then
persistentOptions(idConnection).txtHk6 = 100
End If
If persistentOptions(idConnection).txtHk7 < 100 Then
persistentOptions(idConnection).txtHk7 = 100
End If
If persistentOptions(idConnection).txtHk8 < 100 Then
persistentOptions(idConnection).txtHk8 = 100
End If
If persistentOptions(idConnection).txtHk9 < 100 Then
persistentOptions(idConnection).txtHk9 = 100
End If
If persistentOptions(idConnection).txtHk10 < 100 Then
persistentOptions(idConnection).txtHk10 = 100
End If
If persistentOptions(idConnection).txtHk11 < 100 Then
persistentOptions(idConnection).txtHk11 = 100
End If

    If (persistentOptions(idConnection).chkExiva1 = True) And (persistentOptions(idConnection).txtExiva1 <> "") Then
          If persistentOptions(idConnection).persistvar1 >= CLng(persistentOptions(idConnection).txtHk1) Then
            say = persistentOptions(idConnection).txtExiva1
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar1 = 0
          Else
            persistentOptions(idConnection).persistvar1 = persistentOptions(idConnection).persistvar1 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva2 = True) And (persistentOptions(idConnection).txtExiva2 <> "") Then
          If persistentOptions(idConnection).persistvar2 >= CLng(persistentOptions(idConnection).txtHk2) Then
            say = persistentOptions(idConnection).txtExiva2
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar2 = 0
          Else
            persistentOptions(idConnection).persistvar2 = persistentOptions(idConnection).persistvar2 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva3 = True) And (persistentOptions(idConnection).txtExiva3 <> "") Then
          If persistentOptions(idConnection).persistvar3 >= CLng(persistentOptions(idConnection).txtHk3) Then
            say = persistentOptions(idConnection).txtExiva3
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar3 = 0
          Else
            persistentOptions(idConnection).persistvar3 = persistentOptions(idConnection).persistvar3 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva4 = True) And (persistentOptions(idConnection).txtExiva4 <> "") Then
          If persistentOptions(idConnection).persistvar4 >= CLng(persistentOptions(idConnection).txtHk4) Then
            say = persistentOptions(idConnection).txtExiva4
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar4 = 0
          Else
            persistentOptions(idConnection).persistvar4 = persistentOptions(idConnection).persistvar4 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva5 = True) And (persistentOptions(idConnection).txtExiva5 <> "") Then
          If persistentOptions(idConnection).persistvar5 >= CLng(persistentOptions(idConnection).txtHk5) Then
            say = persistentOptions(idConnection).txtExiva5
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar5 = 0
          Else
            persistentOptions(idConnection).persistvar5 = persistentOptions(idConnection).persistvar5 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva6 = True) And (persistentOptions(idConnection).txtExiva6 <> "") Then
          If persistentOptions(idConnection).persistvar6 >= CLng(persistentOptions(idConnection).txtHk6) Then
            say = persistentOptions(idConnection).txtExiva6
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar6 = 0
          Else
            persistentOptions(idConnection).persistvar6 = persistentOptions(idConnection).persistvar6 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva7 = True) And (persistentOptions(idConnection).txtExiva7 <> "") Then
          If persistentOptions(idConnection).persistvar7 >= CLng(persistentOptions(idConnection).txtHk7) Then
            say = persistentOptions(idConnection).txtExiva7
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar7 = 0
          Else
            persistentOptions(idConnection).persistvar7 = persistentOptions(idConnection).persistvar7 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva8 = True) And (persistentOptions(idConnection).txtExiva8 <> "") Then
          If persistentOptions(idConnection).persistvar8 >= CLng(persistentOptions(idConnection).txtHk8) Then
            say = persistentOptions(idConnection).txtExiva8
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar8 = 0
          Else
            persistentOptions(idConnection).persistvar8 = persistentOptions(idConnection).persistvar8 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva9 = True) And (persistentOptions(idConnection).txtExiva9 <> "") Then
          If persistentOptions(idConnection).persistvar9 >= CLng(persistentOptions(idConnection).txtHk9) Then
            say = persistentOptions(idConnection).txtExiva9
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar9 = 0
          Else
            persistentOptions(idConnection).persistvar9 = persistentOptions(idConnection).persistvar9 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva10 = True) And (persistentOptions(idConnection).txtExiva10 <> "") Then
          If persistentOptions(idConnection).persistvar10 >= CLng(persistentOptions(idConnection).txtHk10) Then
            say = persistentOptions(idConnection).txtExiva10
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar10 = 0
          Else
            persistentOptions(idConnection).persistvar10 = persistentOptions(idConnection).persistvar10 + 100
          End If
    End If
    If (persistentOptions(idConnection).chkExiva11 = True) And (persistentOptions(idConnection).txtExiva11 <> "") Then
          If persistentOptions(idConnection).persistvar11 >= CLng(persistentOptions(idConnection).txtHk11) Then
            say = persistentOptions(idConnection).txtExiva11
            aRes = ExecuteInTibia(say, idConnection, True)
            persistentOptions(idConnection).persistvar11 = 0
          Else
            persistentOptions(idConnection).persistvar11 = persistentOptions(idConnection).persistvar11 + 100
          End If
    End If


End If 'game connected
Next idConnection


End Sub

Public Sub LoadPersistentChars()
  Dim i As Long
  Dim firstC As Long

  firstC = 0
  cmbCharacter.Clear
  cmbCharacter.AddItem "-", 0
  For i = 1 To MAXCLIENTS
    If GameConnected(i) = True Then
      If firstC = 0 Then
        firstC = i
      End If
      cmbCharacter.AddItem CharacterName(i), i
    Else
      cmbCharacter.AddItem "-" & CStr(i) & "- NOT CONNECTED", i
    End If
  Next i
  cmbCharacter.ListIndex = firstC
  cmbCharacter.Text = cmbCharacter.List(firstC)
  persistentIDselected = firstC
  UpdateValues
  
End Sub

Private Sub txtExiva1_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva1 = txtExiva1.Text
End If

End Sub

Private Sub txtExiva10_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva10 = txtExiva10.Text
End If

End Sub

Private Sub txtExiva11_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva11 = txtExiva11.Text
End If

End Sub

Private Sub txtExiva2_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva2 = txtExiva2.Text
End If

End Sub

Private Sub txtExiva3_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva3 = txtExiva3.Text
End If

End Sub

Private Sub txtExiva4_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva4 = txtExiva4.Text
End If

End Sub

Private Sub txtExiva5_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva5 = txtExiva5.Text
End If

End Sub

Private Sub txtExiva6_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva6 = txtExiva6.Text
End If

End Sub

Private Sub txtExiva7_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva7 = txtExiva7.Text
End If

End Sub

Private Sub txtExiva8_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva8 = txtExiva8.Text
End If

End Sub

Private Sub txtExiva9_Validate(Cancel As Boolean)

If persistentIDselected > 0 Then
  persistentOptions(persistentIDselected).txtExiva9 = txtExiva9.Text
End If

End Sub

Private Sub txtHk1_change()

If IsNumeric(txtHk1) = True Then
    ' ok
Else
    txtHk1.Text = "100"
End If

End Sub

Private Sub txtHk10_change()

If IsNumeric(txtHk10) = True Then
    ' ok
Else
    txtHk10.Text = "100"
End If

End Sub

Private Sub txtHk11_change()

If IsNumeric(txtHk11) = True Then
    ' ok
Else
    txtHk11.Text = "100"
End If

End Sub

Private Sub txtHk2_change()

If IsNumeric(txtHk2) = True Then
    ' ok
Else
    txtHk2.Text = "100"
End If

End Sub

Private Sub txtHk3_change()

If IsNumeric(txtHk3) = True Then
    ' ok
Else
    txtHk3.Text = "100"
End If

End Sub

Private Sub txtHk4_change()

If IsNumeric(txtHk4) = True Then
    ' ok
Else
    txtHk4.Text = "100"
End If

End Sub

Private Sub txtHk5_change()

If IsNumeric(txtHk5) = True Then
    ' ok
Else
    txtHk5.Text = "100"
End If

End Sub

Private Sub txtHk6_change()

If IsNumeric(txtHk6) = True Then
    ' ok
Else
    txtHk6.Text = "100"
End If

End Sub

Private Sub txtHk7_change()

If IsNumeric(txtHk7) = True Then
    ' ok
Else
    txtHk7.Text = "100"
End If

End Sub

Private Sub txtHk8_change()

If IsNumeric(txtHk8) = True Then
    ' ok
Else
    txtHk8.Text = "100"
End If

End Sub

Private Sub txtHk9_change()

If IsNumeric(txtHk9) = True Then
    ' ok
Else
    txtHk9.Text = "100"
End If

End Sub
